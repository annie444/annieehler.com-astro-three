import{j as h}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.6otl1p8d.js";import{u as B}from"./useDarkMode.BWRM0mF6.js";const H=({glitchColors:r=["#2b4539","#61dca3","#61b3dc"],glitchSpeed:e=50,centerVignette:t=!1,outerVignette:o=!0,smooth:n=!0,bgColor:l="#000000"})=>{const s=c.useRef(null),a=c.useRef(null),u=c.useRef([]),i=c.useRef({columns:0,rows:0}),f=c.useRef(null),g=c.useRef(Date.now()),d=B(),m=c.useRef("string"==typeof l?l:d?l.dark:l.light),w=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","!","@","#","$","&","*","(",")","-","_","+","=","/","[","]","{","}",";",":","<",">",",","0","1","2","3","4","5","6","7","8","9"];c.useEffect((()=>{"string"!=typeof l&&(m.current=d?l.dark:l.light)}),[d]);const p=()=>w[Math.floor(Math.random()*w.length)],b=()=>r[Math.floor(Math.random()*r.length)],M=r=>{r=r.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((r,e,t,o)=>e+e+t+t+o+o));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},x=()=>{const r=s.current;if(!r)return;const e=r.parentElement;if(!e)return;const t=window.devicePixelRatio||1,o=e.getBoundingClientRect();r.width=o.width*t,r.height=o.height*t,r.style.width=`${o.width}px`,r.style.height=`${o.height}px`,f.current&&f.current.setTransform(t,0,0,t,0,0);const{columns:n,rows:c}=((r,e)=>({columns:Math.ceil(r/10),rows:Math.ceil(e/20)}))(o.width,o.height);((r,e)=>{i.current={columns:r,rows:e};const t=r*e;u.current=Array.from({length:t},(()=>({char:p(),color:b(),targetColor:b(),colorProgress:1})))})(n,c),v()},v=()=>{if(!f.current||0===u.current.length)return;const r=f.current,{width:e,height:t}=s.current.getBoundingClientRect();r.clearRect(0,0,e,t),r.fillStyle=m.current,r.fillRect(0,0,e,t),r.font="16px monospace",r.textBaseline="top",u.current.forEach(((e,t)=>{const o=t%i.current.columns*10,n=20*Math.floor(t/i.current.columns);r.fillStyle=e.color,r.fillText(e.char,o,n)}))},R=()=>{let r=!1;u.current.forEach((e=>{if(e.colorProgress<1){e.colorProgress+=.05,e.colorProgress>1&&(e.colorProgress=1);const t=M(e.color),o=M(e.targetColor);t&&o&&(e.color=((r,e,t)=>`rgb(${Math.round(r.r+(e.r-r.r)*t)}, ${Math.round(r.g+(e.g-r.g)*t)}, ${Math.round(r.b+(e.b-r.b)*t)})`)(t,o,e.colorProgress),r=!0)}})),r&&v()},C=()=>{const r=Date.now();r-g.current>=e&&((()=>{if(!u.current||0===u.current.length)return;const r=Math.max(1,Math.floor(.05*u.current.length));for(let e=0;e<r;e++){const r=Math.floor(Math.random()*u.current.length);u.current[r]&&(u.current[r].char=p(),u.current[r].targetColor=b(),n?u.current[r].colorProgress=0:(u.current[r].color=u.current[r].targetColor,u.current[r].colorProgress=1))}})(),v(),g.current=r),n&&R(),a.current=requestAnimationFrame(C)};return c.useEffect((()=>{const r=s.current;if(!r)return;let e;f.current=r.getContext("2d",{alpha:!1}),x(),C();const t=()=>{clearTimeout(e),e=setTimeout((()=>{cancelAnimationFrame(a.current),x(),C()}),100)};return window.addEventListener("resize",t),()=>{cancelAnimationFrame(a.current),window.removeEventListener("resize",t)}}),[e,n]),h.jsxs("div",{className:"relative h-full min-h-[100vh] w-full min-w-[100vw] overflow-hidden bg-black",children:[h.jsx("canvas",{ref:s,className:"block h-full w-full"}),o&&h.jsx("div",{className:"pointer-events-none absolute top-0 left-0 h-full w-full bg-[radial-gradient(circle,_rgba(0,0,0,0)_60%,_rgba(0,0,0,1)_100%)]"}),t&&h.jsx("div",{className:"pointer-events-none absolute top-0 left-0 h-full w-full bg-[radial-gradient(circle,_rgba(0,0,0,0.8)_0%,_rgba(0,0,0,0)_60%)]"})]})};export{H as LetterGlitch};